FROM python:3.7-alpine3.7

RUN pip install --upgrade pip

MAINTAINER  "Moaaz Noaman" <moaz.refat@hotmail.com> version="1.0.0"

RUN adduser -D moaaz 
USER moaaz
WORKDIR /home/moaaz/

RUN pip install --user pipenv

ENV PATH="/home/moaaz/.local/bin:${PATH}"
COPY --chown=worker:worker Pipfile Pipfile
RUN pipenv lock -r > requirements.txt

RUN pip install --user -r requirements.txt
COPY --chown=moaaz:moaaz . .

EXPOSE 8080
ENTRYPOINT ["python"]
CMD ["./app.py"]
